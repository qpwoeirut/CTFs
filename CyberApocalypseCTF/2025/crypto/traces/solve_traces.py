import string

CHARS = set(string.ascii_letters + string.digits + string.punctuation + ' ')

general_messages = """
[23:30] <Doomfang> : 95df4e2b00d57d52d48e0e623ca1
[23:32] <Stormbane> : 95df4e2b00d56a49d491056133a8be
[23:34] <Runeblight> : 95df4e2b00d56b48d5860a6f3ba1b37e
[00:00] <Stormbane> : e3d4003e0ed55e52cfc309233ca3ac2a1a4750f96973964b07972e1fedc92b32cdccea3aaf00d2a16f1a45b095b04ea4ce0a0bbd016ecc5acd7cea0cc5ee0d9df330
[00:01] <Doomfang> : e1df432d19864d52d48746231aa7a82a1a4645ab6d319b5b16d97a16e6907924c6cee869ee46beb073585bb08cb04ca681100ea64f6a8448d032f91b8cf7199bb672e6a0767c83fb31051a
[00:02] <Runeblight> : fade536812904d119b811d77728ffc674e4d48bc6b7a905014972918e58c7922c1dcf53ce04cbeb7725a58f192a605f4a7035ebb4968dd1bca39f40dc9b8199aba3ef0b6223187f32f1405054a15b8a054c8f51805c57d099d080f1074a9284fd3c8482fb55e
[00:04] <Doomfang> : e0d94e3b4b96515cd58d0d6f72afa82a004154f97b709f5b53d13505a8853639c889f228ed4bedea3b7153e4d9a60ba7990c0aac492dd0549933ef0c8ce81e80e07ff3b6222e81fb2a4e
[00:04] <Doomfang> : fcd4552d4b9c4a1dcf8b0d2322a7a8791e4652b87b74d9581cc57a18fd9b7924cacaf33be400fdac7a5358f592ef0bf1830c4ca85745ec78ef69fc21c7fb0ed4cc2af1864e2d81cd0d464a3f
[00:05] <Runeblight> : f3de53680281171df48d047a72b5b36b1c4b00b07c318e5707df7a18fd9b793ac0daf269f552ebb76f5852b09fb947bd8b1650
[00:06] <Stormbane> : edd454664bba4c4f9b8f097026e6b665184b00b46968d95612c13f57e48c3f238fddf428e245edea3b6a53b093a058a0ce071bef5768d642993ffb0cc9fe1985b8
[00:07] <Doomfang> : fd964a68089d5c5ed08a066472a9ae784e424fbe7b318d5153d53f57fb9c2b328fc7e969f552ffa77e1d59f6deba5ea6ce041dbb4862ca48992eff13cdf1029ab8
[00:08] <Runeblight> : ffd442384b985c1dce930c6226a3bf244e6746f97c799c4753d43b03eb817938c185a63ee407f2a83b5557e69bf55fbbce041dbb016bc548cd72
[00:09] <Stormbane> : fd964b244b965650cb821a6672b2b36f4e4241ad6d628d1e17d62e16a89e3023c789e93cf300fca5785643e0dea547b5804b5e98442dc94eca28ba1bdef91f8cb67fe9aa222f87f3294052080b14b8f24587bd1e1fc13d
[00:10] <Doomfang> : fdd7072d1d904b44cf8b016d35e6b2794e4d4cbc6963d51e04d27a1ae79f3c77dbc6a63de945beaa7e4542b08da14ab38b4b5e80547f845cd63df65ec5eb4c9eff6aefba6c7c9cf126034d43
[00:11] <Runeblight> : fcde4b2c4b9a57139baa4f6e72b5be6f074047f97b658b5f1dd03f57fb803e39cec5f569e752f1a93b5243e48dbc4fb1c04529aa0160cd5cd128ba1cc9b81b88e27defb66672
[00:12] <Stormbane> : e3d4072b0a9b1e499b97096837e6ba64170e52b07b7a8a1053fb3f03af9a793bcac8f02ca154f6ad681d55f89fbb45b182451caa4762d65e9928f21bd5b8189bf77decf3772fc0
[00:13] <Doomfang> : f5d6552d0e91171df68c1e6672a7b7664e5a41b56362d94a1c972e1fedc92925c6dfe73de400ecab745018b0aca045b18c0917a84979881bc930ff1fdffd4c8afa7be6a1222886f1670c4a0a5843b5e552c2fb
[00:14] <Runeblight> : e1df432d19864d52d48746231be1b62a0a4753ba677f975b10c33319efc93738d887a600e700eaac7e4416f89fa34ef49d001ba10178d717992bff5ec1ed1f9db67aeea0632c9ef126120504460eb8e449c6a11e01dd3d
[00:53] <Doomfang> : 95dd42291d90
[00:53] <Stormbane> : 95dd42291d90
[00:53] <Runeblight> : 95dd42291d90
""".strip().split('\n')
secret_messages = """
[00:10] <Doomfang> : 95df4e2b00d57d52d48e0e623ca1
[00:12] <Stormbane> : 95df4e2b00d56a49d491056133a8be
[00:14] <Runeblight> : 95df4e2b00d56b48d5860a6f3ba1b37e
[00:26] <Runeblight> : e3d4073b039a4c51dfc3036637b6fb651b5c00a9647097501ad93d57e08c2b328189d221e400f1b16f5844b096b447b89d451fbd442dca54cd7ce91bcfed1e8cba3ee6bd667c9afb2840480c451afde559c2a65b1ac5670d9008140d63a9335ed5d2012fae11dfe96cc04d29
[01:01] <Doomfang> : f5d6552d0e91171def8b0d2337a8be67170953f97b72964b07c47a10fa862e77c2c6f42ca150fbb6685445e49bbb5fface2c18ef5565c142993ffb0acff04c8ce07be9f3637c99fc2e1355085943b2e600c8a0094dc0761d914f0e162aa92846d5c5013baf1cdda764c34862f3f491fa407d72b026a4be2cd87a1d8e609a8436efe5e455d2ed8966b63343062adb89896631834370be6fe4085298b6a9821c595638764a7f531765668901aee84ac7dfd256fd
[01:02] <Runeblight> : fd96512d4b975c58d5c31b7727a2a263004900ad6074d94a01d63912fbc93532c9dda62be448f7aa7f1d54e9deba5ea6ce150caa5764cb4eca7cf310cff9029df76aeebc6c2fc2b4260e414d580cb0e554cfbc150a84750b9d44134571fb3340d7920103b30291e96cd84968a1fed6f44f3372b463bda171d84519dd2d9c922cbbabe45486ac9663be2a021e319e94946623880677a324e5150585e6a2820e1a4d397b516357547a2e8700fca656dddf824ab50823698772965afc1b9e594140528d1e19bbb41fd3c23b88b01dd6972acdabc38410b753dfa0e460b0decf4d3c8da2c6345c5a1334de68a849cc3c65b8e35051c6b20f657db8d8f1a29557aa0993ccdf67577bf2a9279d8eeb0db9394a747fd13e5cf6822e28762483a803b921f23b7c2aaa7e28fbf83123314723e2b64548ba69f145775642db6243dd6d6a00260534d5bda8c24bcd8829510b407eea234a30b2ec14ea2090a6
[01:03] <Stormbane> : fd964a680a994b58da87112331b4b4791d0343b16d7292571dd07a18fd9b7924dfccea25f64fecaf3b5c51f197bb58a0ce1116aa016cca58d039f40a8cea098af96ce3a02c7ca7f267144d045843bfe541c4ba154dd3721dd858011772a9334890dd4f6ca91cd5e27b8c5b69b0fd97f55d7e64aa72fded4bdf41148e6b869926effbf94e9deacb2a9b3117522bd8c09232628f5522ac2cff13048ee6ae88185502233e5b6312036b668e15aaad19d29ad257bc4a3a7fca3dc367e0548f5f4e4952835c28f3bc4c90ce3a9eb9189a902bcda9c5830cbb53d1e2a32fb59fd45dfe6e59da3e18091e7dde66fd5385286dbce30306caa1126563bbcdb2a59457a90393d0cf76057be8ec2b87cbef46b905436d6f962f47ad
[01:04] <Doomfang> : e3d4072b0a9b5752cfc3096534a9a96e4e4645aa6165984a1ad83459a8a03f77dbc1ef3aa149ede47a1d54e29bb448bcc2450aa74463844fd139ba36c5ff04c9d571f2bd613582b3344043025900b8f300cab4024dc57f1c9d49041c26eb390edfd20123b30291f37bcd576bfdb5b3ed4c7d21b06eb4ed71954c14c2689c8362a2e2f85593e7802aba2b161e269e8494292fc64977bf6fee140682b4a5c70c184f2737576a5c5a2e118354b1bd4ac79ac14abd4e3f68ca33825ab41b82535e055fc51e22a6af4c92d3379cb21cd6912a8ba0c2831dad1dd0edb26ae29cc35c72ceaedc3548081e3c977aed458b
[01:05] <Runeblight> : f1c9462b1f9940139ba2066772a3ad6f000e49bf28669c1e01d23716e1877922c1dae32cef00f8ab691d58ff89f90ba38b4510aa44698458d632ee17c2ff0987f567a7a36e3d80e769406c0b0b17b5e500e4ba0e03c77a02d84e0f1772e03a47d5cf0125b20391ea68cb5764b2f9d6f9486173ad63a3be2ed85a1d8e6e80822eababe74e81e9c56bba270601319e949466368e436bbf6ff80e0084a8a78f00154624781e495d547923c61cbdbe5c93db8256b64b3974c3729157b4198951555616cc586db6b31881d87494ba59829d2acdb5de9915bf4fc1aca36eb69b86506fcebed639541f156e
[01:06] <Stormbane> : edd454644b974c499b940d233fb3a87e4e5a52bc6965d95707973519e4907936dc89e769ed41edb03b4f53e391a75fface2c18ef5668845ada28f308cdec09c9ff6aa7a76d33cee7280f4b410b14b8a052cea6104dd676189d490c0c68ee7c47c4cf0120a913d0f360c35029f3dc82bb406021a867b3a86e9d4958cf7ed5d70a9bc9f06280e587559d36021525d78e9c19079e566ea226ff1b0682a9aeb83810563f0975684b2b40298817b9976bd6cfd140f255
[01:07] <Doomfang> : f3de482c45d577529b910d603db4bf2a014800b07c31944b00c37a12f0802a238fc0e869f548fbe46c4f5fe48ab045f49a0a13aa52238472992bf312c0b80987e56bf5b6223d82f86714570c4806aea041d5b05b08d6721d9d4c4c4567e7380ed9c8013fae11ddeb29c25b71b6e7d6f94c3372b469baa86cd8421e8e629f922ca3f2a501bbeac57eb12143172cdb8d826627904370ed23ee1b0085b5e08809594b237a1e7a5754792f8a18fca058c5df824bbc08257fc47c8d4ab41784515546538d
[01:08] <Runeblight> : f5d6552d0e91171def8b0d233fa9a96f4e5945f96c788a5d06c42957e19d7577dbc1e369e652fba56f5844b08abd4ef49c0c0da40f2de14ddc2ee35ec1f7018cf86aa7a4677c8af12b015c410b17b5e500e4ba0e03c77a02d85b141763e73b5ad8d94f3fe619c5f429c85b61b6fb85fe5a3d219363f1a0778b5958cf6e9bd731a0e4e50190e98365ab21431d37ccc08c2f2c824975ed20ed5a1d9bb6af951b0c4c3e22472d511861358307f2
[01:09] <Stormbane> : e3d4073b039a4c51dfc30d6d36e6af62075d00b46d748d571dd07a16e68d793ac0dfe369f54fbea53b5059e29bf558b18d100caa017ec555da28ef1382b8258fb66aefb66b2ecef92607401e0b0cafa053d7bc1e1e84721c9d08030969fa3540d79c4822ea50c5ef6cd51e6ab2ecd6f2476764b665b4bd76d8420ddc2d989830abf8a501a5e9c567ac3717522cd194db32238d4322b927ea0e5288aea1890c1c0c771a5b791200662f9554bead19c7d2c705bf49256e877e865de7158b551b4c58834a25baae4c83cd359eb957
[01:09] <Runeblight> : 95dd42291d90
[01:09] <Stormbane> : 95dd42291d90
[01:09] <Doomfang> : 95dd42291d90
""".strip().split('\n')
messages = general_messages + secret_messages
messages = [msg.split(' : ')[1] for msg in messages]

pad: list[int | None] = [None for _ in range(max(len(msg) for msg in messages))]

# Only one of these is really necessary, these are in a list to show how progress was made
known = [  # determined experimentally that the commands are in lowercase
    ("!nick Doomfang", "95df4e2b00d57d52d48e0e623ca1"),
    ("!nick Stormbane", "95df4e2b00d56a49d491056133a8be"),
    ("!nick Runeblight", "95df4e2b00d56b48d5860a6f3ba1b37e"),
    ("!leave", "95dd42291d90"),
    # started guessing below here
    ("Hold on. I'm seeing ", "fcde4b2c4b9a57139baa4f6e72b5be6f074047f97b658b5f1dd03f57fb803e39cec5f569e752f1a93b5243e48dbc4fb1c04529aa0160cd5cd128ba1cc9b81b88e27defb66672"),
    ("Here is the passphrase", "fcd4552d4b9c4a1dcf8b0d2322a7a8791e4652b87b74d9581cc57a18fd9b7924cacaf33be400fdac7a5358f592ef0bf1830c4ca85745ec78ef69fc21c7fb0ed4cc2af1864e2d81cd0d464a3f"),
    ("Understood. I'm disconnecting", "e1df432d19864d52d48746231be1b62a0a4753ba677f975b10c33319efc93738d887a600e700eaac7e4416f89fa34ef49d001ba10178d717992bff5ec1ed1f9db67aeea0632c9ef126120504460eb8e449c6a11e01dd3d"),
    ("Keep me updated. If they catch ", "ffd442384b985c1dce930c6226a3bf244e6746f97c799c4753d43b03eb817938c185a63ee407f2a83b5557e69bf55fbbce041dbb016bc548cd72"),
    ("Yes. Our last move may have left ", "edd454664bba4c4f9b8f097026e6b665184b00b46968d95612c13f57e48c3f238fddf428e245edea3b6a53b093a058a0ce071bef5768d642993ffb0cc9fe1985b8"),
    ("Not yet, but I\'m checking some unusual", "fade536812904d119b811d77728ffc674e4d48bc6b7a905014972918e58c7922c1dcf53ce04cbeb7725a58f192a605f4a7035ebb4968dd1bca39f40dc9b8199aba3ef0b6223187f32f1405054a15b8a054c8f51805c57d099d080f1074a9284fd3c8482fb55e"),
    ("Got it. Only share it with our most trusted ", "f3de53680281171df48d047a72b5b36b1c4b00b07c318e5707df7a18fd9b793ac0daf269f552ebb76f5852b09fb947bd8b1650"),
    ("We can't take any risks. Let's leave this channel", "e3d4072b0a9b1e499b97096837e6ba64170e52b07b7a8a1053fb3f03af9a793bcac8f02ca154f6ad681d55f89fbb45b182451caa4762d65e9928f21bd5b8189bf77decf3772fc0"),
    ("Agreed. Move all talks to the private room. Runeblight", "f5d6552d0e91171df68c1e6672a7b7664e5a41b56362d94a1c972e1fedc92925c6dfe73de400ecab745018b0aca045b18c0917a84979881bc930ff1fdffd4c8afa7be6a1222886f1670c4a0a5843b5e552c2fb"),
    ("Keep me updated. If they catch on, we'll have to act fast.", "ffd442384b985c1dce930c6226a3bf244e6746f97c799c4753d43b03eb817938c185a63ee407f2a83b5557e69bf55fbbce041dbb016bc548cd72"),
    ("Yes. Our last move may have left traces. We must be very careful.", "edd454664bba4c4f9b8f097026e6b665184b00b46968d95612c13f57e48c3f238fddf428e245edea3b6a53b093a058a0ce071bef5768d642993ffb0cc9fe1985b8"),
    ("This channel is not safe for long talks. Let\'s switch to our private room.", "e0d94e3b4b96515cd58d0d6f72afa82a004154f97b709f5b53d13505a8853639c889f228ed4bedea3b7153e4d9a60ba7990c0aac492dd0549933ef0c8ce81e80e07ff3b6222e81fb2a4e"),
    ("If everything is clear, we move to the next stage. Our goal is within reach.", "fdd7072d1d904b44cf8b016d35e6b2794e4d4cbc6963d51e04d27a1ae79f3c77dbc6a63de945beaa7e4542b08da14ab38b4b5e80547f845cd63df65ec5eb4c9eff6aefba6c7c9cf126034d43"),
    # This is enough to get the channel key, but we need to keep going once we get the #secret channel messages
    ("I'll compare the latest data with our backup plan. We must erase any sign we were ", "fd964b244b965650cb821a6672b2b36f4e4241ad6d628d1e17d62e16a89e3023c789e93cf300fca5785643e0dea547b5804b5e98442dc94eca28ba1bdef91f8cb67fe9aa222f87f3294052080b14b8f24587bd1e1fc13d"),
    ("Understood. I'm disconnecting now. If they have seen us, we must disappear immediately.", "e1df432d19864d52d48746231be1b62a0a4753ba677f975b10c33319efc93738d887a600e700eaac7e4416f89fa34ef49d001ba10178d717992bff5ec1ed1f9db67aeea0632c9ef126120504460eb8e449c6a11e01dd3d"),
    ("Not yet, but I'm checking some unusual signals. If they sense us, we might have to change ", "fade536812904d119b811d77728ffc674e4d48bc6b7a905014972918e58c7922c1dcf53ce04cbeb7725a58f192a605f4a7035ebb4968dd1bca39f40dc9b8199aba3ef0b6223187f32f1405054a15b8a054c8f51805c57d099d080f1074a9284fd3c8482fb55e"),
    ("Yes, but we must treat it only as a last resort. If we activate it too soon, we risk revealing ", "edd454644b974c499b940d233fb3a87e4e5a52bc6965d95707973519e4907936dc89e769ed41edb03b4f53e391a75fface2c18ef5668845ada28f308cdec09c9ff6aa7a76d33cee7280f4b410b14b8a052cea6104dd676189d490c0c68ee7c47c4cf0120a913d0f360c35029f3dc82bb406021a867b3a86e9d4958cf7ed5d70a9bc9f06280e587559d36021525d78e9c19079e566ea226ff1b0682a9aeb83810563f0975684b2b40298817b9976bd6cfd140f255"),
    ("Agreed. The more we discuss it, the greater the risk. Every moment we delay, the Council strengthens", "f5d6552d0e91171def8b0d233fa9a96f4e5945f96c788a5d06c42957e19d7577dbc1e369e652fba56f5844b08abd4ef49c0c0da40f2de14ddc2ee35ec1f7018cf86aa7a4677c8af12b015c410b17b5e500e4ba0e03c77a02d85b141763e73b5ad8d94f3fe619c5f429c85b61b6fb85fe5a3d219363f1a0778b5958cf6e9bd731a0e4e50190e98365ab21431d37ccc08c2f2c824975ed20ed5a1d9bb6af951b0c4c3e22472d511861358307f2"),
    ("We should keep our planning here. The outer halls are not secure, and too many eyes watch the open channels.", "e3d4073b039a4c51dfc3036637b6fb651b5c00a9647097501ad93d57e08c2b328189d221e400f1b16f5844b096b447b89d451fbd442dca54cd7ce91bcfed1e8cba3ee6bd667c9afb2840480c451afde559c2a65b1ac5670d9008140d63a9335ed5d2012fae11dfe96cc04d29"),
    ("I've been studying the traces left behind by our previous incantations, and something feels wrong. Our network ", "fd96512d4b975c58d5c31b7727a2a263004900ad6074d94a01d63912fbc93532c9dda62be448f7aa7f1d54e9deba5ea6ce150caa5764cb4eca7cf310cff9029df76aeebc6c2fc2b4260e414d580cb0e554cfbc150a84750b9d44134571fb3340d7920103b30291e96cd84968a1fed6f44f3372b463bda171d84519dd2d9c922cbbabe45486ac9663be2a021e319e94946623880677a324e5150585e6a2820e1a4d397b516357547a2e8700fca656dddf824ab50823698772965afc1b9e594140528d1e19bbb41fd3c23b88b01dd6972acdabc38410b753dfa0e460b0decf4d3c8da2c6345c5a1334de68a849cc3c65b8e35051c6b20f657db8d8f1a29557aa0993ccdf67577bf2a9279d8eeb0db9394a747fd13e5cf6822e28762483a803b921f23b7c2aaa7e28fbf83123314723e2b64548ba69f145775642db6243dd6d6a00260534d5bda8c24bcd8829510b407eea234a30b2ec14ea2090a6"),
    ("I'm already cross-checking our spellwork against the ancient records. If this beacon was part of an older enchantment", "fd964a680a994b58da87112331b4b4791d0343b16d7292571dd07a18fd9b7924dfccea25f64fecaf3b5c51f197bb58a0ce1116aa016cca58d039f40a8cea098af96ce3a02c7ca7f267144d045843bfe541c4ba154dd3721dd858011772a9334890dd4f6ca91cd5e27b8c5b69b0fd97f55d7e64aa72fded4bdf41148e6b869926effbf94e9deacb2a9b3117522bd8c09232628f5522ac2cff13048ee6ae88185502233e5b6312036b668e15aaad19d29ad257bc4a3a7fca3dc367e0548f5f4e4952835c28f3bc4c90ce3a9eb9189a902bcda9c5830cbb53d1e2a32fb59fd45dfe6e59da3e18091e7dde66fd5385286dbce30306caa1126563bbcdb2a59457a90393d0cf76057be8ec2b87cbef46b905436d6f962f47ad"),
    ("Good. No record of it must exist in the written tomes. I will ensure all traces are erased, and it shall never be spoken of", "f3de482c45d577529b910d603db4bf2a014800b07c31944b00c37a12f0802a238fc0e869f548fbe46c4f5fe48ab045f49a0a13aa52238472992bf312c0b80987e56bf5b6223d82f86714570c4806aea041d5b05b08d6721d9d4c4c4567e7380ed9c8013fae11ddeb29c25b71b6e7d6f94c3372b469baa86cd8421e8e629f922ca3f2a501bbeac57eb12143172cdb8d826627904370ed23ee1b0085b5e08809594b237a1e7a5754792f8a18fca058c5df824bbc08257fc47c8d4ab41784515546538d"),
    ("We cannot afford hesitation. If this is a breach, then the High Council's forces may already be on our trail. Even the smallest ", "e3d4072b0a9b5752cfc3096534a9a96e4e4645aa6165984a1ad83459a8a03f77dbc1ef3aa149ede47a1d54e29bb448bcc2450aa74463844fd139ba36c5ff04c9d571f2bd613582b3344043025900b8f300cab4024dc57f1c9d49041c26eb390edfd20123b30291f37bcd576bfdb5b3ed4c7d21b06eb4ed71954c14c2689c8362a2e2f85593e7802aba2b161e269e8494292fc64977bf6fee140682b4a5c70c184f2737576a5c5a2e118354b1bd4ac79ac14abd4e3f68ca33825ab41b82535e055fc51e22a6af4c92d3379cb21cd6912a8ba0c2831dad1dd0edb26ae29cc35c72ceaedc3548081e3c977aed458b"),
    ("Yes, but we must treat it only as a last resort. If we activate it too soon, we risk revealing its location. It is labeled as: HTB{", "edd454644b974c499b940d233fb3a87e4e5a52bc6965d95707973519e4907936dc89e769ed41edb03b4f53e391a75fface2c18ef5668845ada28f308cdec09c9ff6aa7a76d33cee7280f4b410b14b8a052cea6104dd676189d490c0c68ee7c47c4cf0120a913d0f360c35029f3dc82bb406021a867b3a86e9d4958cf7ed5d70a9bc9f06280e587559d36021525d78e9c19079e566ea226ff1b0682a9aeb83810563f0975684b2b40298817b9976bd6cfd140f255"),
    ("We cannot afford hesitation. If this is a breach, then the High Council's forces may already be on our trail. Even the smallest mistake ", "e3d4072b0a9b5752cfc3096534a9a96e4e4645aa6165984a1ad83459a8a03f77dbc1ef3aa149ede47a1d54e29bb448bcc2450aa74463844fd139ba36c5ff04c9d571f2bd613582b3344043025900b8f300cab4024dc57f1c9d49041c26eb390edfd20123b30291f37bcd576bfdb5b3ed4c7d21b06eb4ed71954c14c2689c8362a2e2f85593e7802aba2b161e269e8494292fc64977bf6fee140682b4a5c70c184f2737576a5c5a2e118354b1bd4ac79ac14abd4e3f68ca33825ab41b82535e055fc51e22a6af4c92d3379cb21cd6912a8ba0c2831dad1dd0edb26ae29cc35c72ceaedc3548081e3c977aed458b"),
    ("Agreed. The more we discuss it, the greater the risk. Every moment we delay, the Council strengthens its defenses. We must act soon before ", "f5d6552d0e91171def8b0d233fa9a96f4e5945f96c788a5d06c42957e19d7577dbc1e369e652fba56f5844b08abd4ef49c0c0da40f2de14ddc2ee35ec1f7018cf86aa7a4677c8af12b015c410b17b5e500e4ba0e03c77a02d85b141763e73b5ad8d94f3fe619c5f429c85b61b6fb85fe5a3d219363f1a0778b5958cf6e9bd731a0e4e50190e98365ab21431d37ccc08c2f2c824975ed20ed5a1d9bb6af951b0c4c3e22472d511861358307f2"),
    ("We cannot afford hesitation. If this is a breach, then the High Council's forces may already be on our trail. Even the smallest mistake could ", "e3d4072b0a9b5752cfc3096534a9a96e4e4645aa6165984a1ad83459a8a03f77dbc1ef3aa149ede47a1d54e29bb448bcc2450aa74463844fd139ba36c5ff04c9d571f2bd613582b3344043025900b8f300cab4024dc57f1c9d49041c26eb390edfd20123b30291f37bcd576bfdb5b3ed4c7d21b06eb4ed71954c14c2689c8362a2e2f85593e7802aba2b161e269e8494292fc64977bf6fee140682b4a5c70c184f2737576a5c5a2e118354b1bd4ac79ac14abd4e3f68ca33825ab41b82535e055fc51e22a6af4c92d3379cb21cd6912a8ba0c2831dad1dd0edb26ae29cc35c72ceaedc3548081e3c977aed458b"),
    ("Good. No record of it must exist in the written tomes. I will ensure all traces are erased, and it shall never be spoken of openly. If the enemy ", "f3de482c45d577529b910d603db4bf2a014800b07c31944b00c37a12f0802a238fc0e869f548fbe46c4f5fe48ab045f49a0a13aa52238472992bf312c0b80987e56bf5b6223d82f86714570c4806aea041d5b05b08d6721d9d4c4c4567e7380ed9c8013fae11ddeb29c25b71b6e7d6f94c3372b469baa86cd8421e8e629f922ca3f2a501bbeac57eb12143172cdb8d826627904370ed23ee1b0085b5e08809594b237a1e7a5754792f8a18fca058c5df824bbc08257fc47c8d4ab41784515546538d"),
    ("We cannot afford hesitation. If this is a breach, then the High Council's forces may already be on our trail. Even the smallest mistake could doom ", "e3d4072b0a9b5752cfc3096534a9a96e4e4645aa6165984a1ad83459a8a03f77dbc1ef3aa149ede47a1d54e29bb448bcc2450aa74463844fd139ba36c5ff04c9d571f2bd613582b3344043025900b8f300cab4024dc57f1c9d49041c26eb390edfd20123b30291f37bcd576bfdb5b3ed4c7d21b06eb4ed71954c14c2689c8362a2e2f85593e7802aba2b161e269e8494292fc64977bf6fee140682b4a5c70c184f2737576a5c5a2e118354b1bd4ac79ac14abd4e3f68ca33825ab41b82535e055fc51e22a6af4c92d3379cb21cd6912a8ba0c2831dad1dd0edb26ae29cc35c72ceaedc3548081e3c977aed458b"),
    ("Good. No record of it must exist in the written tomes. I will ensure all traces are erased, and it shall never be spoken of openly. If the enemy ever ", "f3de482c45d577529b910d603db4bf2a014800b07c31944b00c37a12f0802a238fc0e869f548fbe46c4f5fe48ab045f49a0a13aa52238472992bf312c0b80987e56bf5b6223d82f86714570c4806aea041d5b05b08d6721d9d4c4c4567e7380ed9c8013fae11ddeb29c25b71b6e7d6f94c3372b469baa86cd8421e8e629f922ca3f2a501bbeac57eb12143172cdb8d826627904370ed23ee1b0085b5e08809594b237a1e7a5754792f8a18fca058c5df824bbc08257fc47c8d4ab41784515546538d"),
    ("I've been studying the traces left behind by our previous incantations, and something feels wrong. Our network of spells has sent out signals to an unknown ", "fd96512d4b975c58d5c31b7727a2a263004900ad6074d94a01d63912fbc93532c9dda62be448f7aa7f1d54e9deba5ea6ce150caa5764cb4eca7cf310cff9029df76aeebc6c2fc2b4260e414d580cb0e554cfbc150a84750b9d44134571fb3340d7920103b30291e96cd84968a1fed6f44f3372b463bda171d84519dd2d9c922cbbabe45486ac9663be2a021e319e94946623880677a324e5150585e6a2820e1a4d397b516357547a2e8700fca656dddf824ab50823698772965afc1b9e594140528d1e19bbb41fd3c23b88b01dd6972acdabc38410b753dfa0e460b0decf4d3c8da2c6345c5a1334de68a849cc3c65b8e35051c6b20f657db8d8f1a29557aa0993ccdf67577bf2a9279d8eeb0db9394a747fd13e5cf6822e28762483a803b921f23b7c2aaa7e28fbf83123314723e2b64548ba69f145775642db6243dd6d6a00260534d5bda8c24bcd8829510b407eea234a30b2ec14ea2090a6"),
    ("Agreed. The more we discuss it, the greater the risk. Every moment we delay, the Council strengthens its defenses. We must act soon before our window of opportunity closes.", "f5d6552d0e91171def8b0d233fa9a96f4e5945f96c788a5d06c42957e19d7577dbc1e369e652fba56f5844b08abd4ef49c0c0da40f2de14ddc2ee35ec1f7018cf86aa7a4677c8af12b015c410b17b5e500e4ba0e03c77a02d85b141763e73b5ad8d94f3fe619c5f429c85b61b6fb85fe5a3d219363f1a0778b5958cf6e9bd731a0e4e50190e98365ab21431d37ccc08c2f2c824975ed20ed5a1d9bb6af951b0c4c3e22472d511861358307f2"),
    ("Exactly. And even if we remain unseen for now, we need contingency plans. If the Council fortifies its magical barriers, we could lose access to their strongholds. Do we have ", "f1c9462b1f9940139ba2066772a3ad6f000e49bf28669c1e01d23716e1877922c1dae32cef00f8ab691d58ff89f90ba38b4510aa44698458d632ee17c2ff0987f567a7a36e3d80e769406c0b0b17b5e500e4ba0e03c77a02d84e0f1772e03a47d5cf0125b20391ea68cb5764b2f9d6f9486173ad63a3be2ed85a1d8e6e80822eababe74e81e9c56bba270601319e949466368e436bbf6ff80e0084a8a78f00154624781e495d547923c61cbdbe5c93db8256b64b3974c3729157b4198951555616cc586db6b31881d87494ba59829d2acdb5de9915bf4fc1aca36eb69b86506fcebed639541f156e"),
    ("Good. No record of it must exist in the written tomes. I will ensure all traces are erased, and it shall never be spoken of openly. If the enemy ever learns of it, we will have ", "f3de482c45d577529b910d603db4bf2a014800b07c31944b00c37a12f0802a238fc0e869f548fbe46c4f5fe48ab045f49a0a13aa52238472992bf312c0b80987e56bf5b6223d82f86714570c4806aea041d5b05b08d6721d9d4c4c4567e7380ed9c8013fae11ddeb29c25b71b6e7d6f94c3372b469baa86cd8421e8e629f922ca3f2a501bbeac57eb12143172cdb8d826627904370ed23ee1b0085b5e08809594b237a1e7a5754792f8a18fca058c5df824bbc08257fc47c8d4ab41784515546538d"),
    ("Agreed. The enemy's scouts grow more persistent. If they catch even a whisper of our designs, they will move against us. We must not allow their seers or spies to track our steps.", "f5d6552d0e91171def8b0d2337a8be67170953f97b72964b07c47a10fa862e77c2c6f42ca150fbb6685445e49bbb5fface2c18ef5565c142993ffb0acff04c8ce07be9f3637c99fc2e1355085943b2e600c8a0094dc0761d914f0e162aa92846d5c5013baf1cdda764c34862f3f491fa407d72b026a4be2cd87a1d8e609a8436efe5e455d2ed8966b63343062adb89896631834370be6fe4085298b6a9821c595638764a7f531765668901aee84ac7dfd256fd"),
    ("I'm already cross-checking our spellwork against the ancient records. If this beacon was part of an older enchantment, I'll find proof. But if it is active now, then we have a problem", "fd964a680a994b58da87112331b4b4791d0343b16d7292571dd07a18fd9b7924dfccea25f64fecaf3b5c51f197bb58a0ce1116aa016cca58d039f40a8cea098af96ce3a02c7ca7f267144d045843bfe541c4ba154dd3721dd858011772a9334890dd4f6ca91cd5e27b8c5b69b0fd97f55d7e64aa72fded4bdf41148e6b869926effbf94e9deacb2a9b3117522bd8c09232628f5522ac2cff13048ee6ae88185502233e5b6312036b668e15aaad19d29ad257bc4a3a7fca3dc367e0548f5f4e4952835c28f3bc4c90ce3a9eb9189a902bcda9c5830cbb53d1e2a32fb59fd45dfe6e59da3e18091e7dde66fd5385286dbce30306caa1126563bbcdb2a59457a90393d0cf76057be8ec2b87cbef46b905436d6f962f47ad")
]
for pt, ct_hex in known:
    for i, byte in enumerate(bytes.fromhex(ct_hex)):
        if i < len(pt):
            value = byte ^ ord(pt[i])
            assert pad[i] is None or pad[i] == value
            pad[i] = value

for msg in messages:
    message = bytes(byte ^ pad[i] if pad[i] is not None else ord('?') for i, byte in enumerate(bytes.fromhex(msg)))
    print(message, msg)

# HTB{Crib_Dragging_Exploitation_With_Key_Nonce_Reuse!}

flag_xor_p = 137045377387787441444931476884439252599798047426097092075851187597439595168075188862420458752976325074626326750004294991847752629752081841086767491386954903130196083903650983778208119471150359775074919174169662074118867374611117601494377118689151148896863117079599812881978072049834420658115912851196823171271
flag_xor_q = 146634069651666980459679589593453836739184422082755405607178137100700761522760722047941705037440386122713502947607147663203471494537915172321956403706318903282064534759738588306009523678524510182803051128503472505729881500173547087053814267062883844115215420987492481758349375204169291416367992906446164661577
N = p_times_q = 20095521413319810714426235563388231961169145196537914976614999825599677810662232771108476583756650076879619943685523293739309070051765986155595576993659498048322778832645139631735697622189789465886583767629622027287095583392521321827657792900724386202742225909874229607758655764834617229100512120799316230700246162360355166741759405508766267037765462073963692444782739074769240653782312579175770928949737186650860542825625518413883622190292794311778995375770251232148134329194441231962194916878314905983111602359919127153847328402812729279045573929433824352138267178119206952261163947033024961233595068842462791119039

e = 65537
c = 20011764181909938499037317942729050140625917825658248378086024603114920339294601426315173983234138265091532718753319150734174675077700486779432501172598948280609625963881366028562461469686956056910135108955518762594121679068796953972719955157980131680719001586097715548222675386305162947030136766942741657780275439265318670963396744826468044213704403665907368527536305397214015619168665100168701842039944364769906382630601425254901004199888128363995088338044108473674868820424980418344442440243136899317859679009966950823150804966608105523311777655983171671776999999304930234970234118540454347317946033950806913524277

p_xor_q = flag_xor_p ^ flag_xor_q


def main():
    options = [(0, 0)]
    for i in range(1024):
        print(i, len(options))
        new_options = []

        for b_p in range(2):
            b_q = b_p ^ ((p_xor_q >> i) & 1)
            for option in options:
                opt_p, opt_q = option[0] | (b_p << i), option[1] | (b_q << i)
                if (opt_p * opt_q) % (1 << (i + 1)) == p_times_q % (1 << (i + 1)):
                    new_options.append((opt_p, opt_q))

        options = new_options

    for p, q in options:
        assert p ^ q == p_xor_q
        if p * q != p_times_q:
            continue

        d = pow(e, -1, (p - 1) * (q - 1))
        flag = pow(c, d, N)
        print(flag.to_bytes((flag.bit_length() + 7) // 8, byteorder='big'))


if __name__ == '__main__':
    main()
